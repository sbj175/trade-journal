<!DOCTYPE html>
<html>
<head>
    <title>Test State Persistence</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-4">Trade Journal State Persistence Test</h1>
        
        <div class="bg-slate-800 rounded-lg p-6 mb-4">
            <h2 class="text-lg font-semibold mb-3">Current Saved State:</h2>
            <pre id="currentState" class="bg-slate-700 p-4 rounded text-sm overflow-auto"></pre>
        </div>
        
        <div class="bg-slate-800 rounded-lg p-6 mb-4">
            <h2 class="text-lg font-semibold mb-3">Actions:</h2>
            <div class="space-y-2">
                <button onclick="refreshState()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-white font-medium">
                    Refresh State Display
                </button>
                <button onclick="clearState()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-white font-medium">
                    Clear Saved State
                </button>
                <button onclick="setSampleState()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-white font-medium">
                    Set Sample State
                </button>
            </div>
        </div>
        
        <div class="bg-slate-800 rounded-lg p-6">
            <h2 class="text-lg font-semibold mb-3">Instructions:</h2>
            <ol class="list-decimal list-inside space-y-2 text-sm">
                <li>Open the Trade Journal in another tab</li>
                <li>Select an account and underlying filter</li>
                <li>Click "Refresh State Display" here to see the saved values</li>
                <li>Refresh the Trade Journal page</li>
                <li>Check if the dropdowns retained their values</li>
            </ol>
        </div>
    </div>
    
    <script>
        function refreshState() {
            const state = localStorage.getItem('tradeJournalState');
            const display = document.getElementById('currentState');
            
            if (state) {
                try {
                    const parsed = JSON.parse(state);
                    display.textContent = JSON.stringify(parsed, null, 2);
                } catch (e) {
                    display.textContent = 'Error parsing state: ' + e.message;
                }
            } else {
                display.textContent = 'No saved state found';
            }
        }
        
        function clearState() {
            localStorage.removeItem('tradeJournalState');
            refreshState();
            alert('State cleared! Refresh the Trade Journal page to see the effect.');
        }
        
        function setSampleState() {
            const sampleState = {
                selectedAccount: '5WZ28644',
                filterUnderlying: 'IBIT',
                filterStrategy: '',
                filterStatus: '',
                syncDays: 30,
                sortColumn: 'underlying',
                sortDirection: 'asc'
            };
            
            localStorage.setItem('tradeJournalState', JSON.stringify(sampleState));
            refreshState();
            alert('Sample state set! Refresh the Trade Journal page to see account 5WZ28644 and IBIT filter pre-selected.');
        }
        
        // Auto-refresh on load
        window.onload = function() {
            refreshState();
        };
    </script>
</body>
</html>